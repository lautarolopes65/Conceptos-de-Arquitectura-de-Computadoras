TIMER EQU 10H
EOI EQU 20H 
IMR EQU 21H
INT1 EQU 25H
PIO EQU 30H
N_TIMER EQU 10 

ORG 40
IP_TIMER DW RUT_TIMER

ORG 1000H
ESTADO DB ?

ORG 3000H
LUCES12:
  MOV BX,SP
  ADD BX,2
  MOV BX,[BX]
  MOV AL,byte ptr[BX]
  AND AL,10000000b
  JNZ ENCENDER
  MOV DL,1
  JMP termino
ENCENDER:
  MOV AL,0FFH
  OUT PIO+1,AL
  MOV AL,0
  OUT TIMER,AL
  MOV AL,12
  OUT TIMER+1,AL
termino:
  RET
  
ORG 3250H
CONF_LUCES:
  MOV AL,0FFH
  OUT PIO+2,AL
  MOV AL,00H
  OUT PIO+3,AL
RET

ORG 3500H
RUT_TIMER:
  MOV AL,0
  OUT PIO+1,AL
  MOV DL,1
  MOV AL,EOI
  OUT EOI,AL
IRET
ORG 2000H 
  CLI
  MOV AL,0FDH
  OUT IMR,AL
  MOV AL,N_TIMER
  OUT INT1,AL
  STI
  
  CALL CONF_LUCES
  IN AL,PIO ;leo estado de llaves
  MOV ESTADO,AL ;lo mando a la memoria
  MOV BX,OFFSET ESTADO
  MOV DL,0
  PUSH BX
  CALL LUCES12
  POP BX
LAZO: CMP DL,1
  JNZ LAZO
 INT 0
END