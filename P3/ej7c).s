EOI EQU 20H 
IMR EQU 21H
INT0 EQU 24H
INT1 EQU 25H
INT2 EQU 26H
HAND_DATO EQU 40H
HAND_ESTADO EQU 41H

N_HAND EQU 10 
N_F10 EQU 15 

ORG 40
IP_HAND DW RUT_HAND
ORG 60
IP_F10 DW RUT_F10

ORG 1000H
LONG DB 10
MSJ DB ?
ORG 3000H
RUT_HAND:
  PUSH AX
  MOV AL,[BX]
  OUT HAND_DATO,AL
  INC BX
  DEC LONG
  MOV AL,EOI
  OUT EOI,AL
  POP AX
IRET
ORG 3500H
RUT_F10:
  PUSH AX
  
  IN AL,HAND_ESTADO
  AND AL,01111111b
  OUT HAND_ESTADO,AL
  MOV LONG,0
  MOV AL,EOI
  OUT EOI,AL
  POP AX
IRET
ORG 2000H 
; Configuro la PIC
CLI
  MOV AL,0FAH
  OUT IMR,AL ; IMR = 1111 1010
  
  MOV AL,N_HAND
  OUT INT2,AL
  MOV AL,N_F10
  OUT INT0,AL
STI 

  MOV BX,OFFSET MSJ
  MOV AH,LONG
LOOP:
  INT 6
  INC BX
  DEC AH
  CMP AH,0
  JNZ LOOP
  
  MOV BX,OFFSET MSJ
  MOV AH,LONG
  
  IN AL,HAND_ESTADO
  OR AL,80H ; 1000 0000b
  OUT HAND_ESTADO,AL
  
LAZO: CMP LONG,0
  JNZ LAZO
  
  MOV AL,0FFH
  OUT IMR,AL
 INT 0
END